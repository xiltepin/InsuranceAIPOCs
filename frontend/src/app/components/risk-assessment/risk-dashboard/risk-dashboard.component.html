<div class="risk-dashboard">
  <header class="dashboard-header">
    <h1>ãƒªã‚¹ã‚¯è©•ä¾¡ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
    <p class="subtitle">Risk Assessment & Dynamic Pricing Dashboard</p>
  </header>

  <div class="dashboard-grid">
    <!-- Driver List -->
    <section class="card driver-list">
      <h2>ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ä¸€è¦§</h2>
      <div class="drivers">
        <div *ngFor="let driver of driverProfiles" 
             class="driver-card"
             (click)="analyzeDriver(driver.id)">
          <div class="driver-info">
            <h3>{{ driver.name }}</h3>
            <p>ID: {{ driver.id }} | å¹´é½¢: {{ driver.age }}æ­³</p>
          </div>
          <div class="risk-badge" [style.background-color]="getRiskColor(driver.category)">
            <span class="risk-score">{{ driver.riskScore }}</span>
            <span class="risk-label">{{ getJapaneseRiskLabel(driver.category) }}</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Risk Score Card -->
    <section class="card risk-analysis" *ngIf="currentRiskScore">
      <h2>ãƒªã‚¹ã‚¯åˆ†æçµæœ</h2>
      <div class="score-display">
        <div class="score-circle" [style.border-color]="getRiskColor(currentRiskScore.riskCategory)">
          <span class="score-value">{{ currentRiskScore.riskScore }}</span>
          <span class="score-max">/100</span>
        </div>
        <div class="score-details">
          <h3>{{ getJapaneseRiskLabel(currentRiskScore.riskCategory) }}</h3>
          <p>æ¨å¥¨ä¿é™ºæ–™: Â¥{{ currentRiskScore.recommendedPremium.toLocaleString() }}</p>
          <p class="discount" *ngIf="currentRiskScore.discount > 0">
            å‰²å¼•é¡: Â¥{{ currentRiskScore.discount.toLocaleString() }}
          </p>
        </div>
      </div>

      <div class="risk-factors">
        <h3>ãƒªã‚¹ã‚¯è¦å› ã®å†…è¨³</h3>
        <div class="factor" *ngFor="let factor of getFactorArray(currentRiskScore.factors)">
          <span class="factor-label">{{ factor.label }}</span>
          <div class="factor-bar">
            <div class="factor-fill" [style.width.%]="factor.value"></div>
          </div>
          <span class="factor-value">{{ factor.value }}</span>
        </div>
      </div>
    </section>

    <!-- Scenario Simulator -->
    <section class="card scenario-sim">
      <h2>ã‚·ãƒŠãƒªã‚ªã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h2>
      <div class="simulator-controls">
        <label for="scenario">ã‚·ãƒŠãƒªã‚ªã‚’é¸æŠ:</label>
        <select id="scenario" [(ngModel)]="selectedScenario" class="scenario-select">
          <option value="newDriver">æ–°è¦ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ (22æ­³)</option>
          <option value="elderly">é«˜é½¢ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ (68æ­³)</option>
          <option value="safeDriving">å®‰å…¨é‹è»¢è€… (40æ­³)</option>
        </select>
        <button (click)="simulateScenario()" [disabled]="loading" class="btn-primary">
          {{ loading ? 'ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä¸­...' : 'ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ' }}
        </button>
      </div>
      <div class="simulator-info">
        <p>ğŸš— Usage-based insurance (UBI) å¯¾å¿œ</p>
        <p>ğŸ“Š National Police Agency ãƒ‡ãƒ¼ã‚¿çµ±åˆ</p>
        <p>ğŸ”Œ OBD-II ãƒ‡ãƒã‚¤ã‚¹é€£æº</p>
      </div>
    </section>

    <!-- IoT Integration Status -->
    <section class="card iot-status">
      <h2>IoTãƒ‡ãƒã‚¤ã‚¹çŠ¶æ³</h2>
      <div class="device-list">
        <div class="device-item">
          <span class="device-icon">ğŸ”Œ</span>
          <div class="device-info">
            <h4>OBD-II Tracker #1</h4>
            <p>Status: <span class="status-active">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–</span></p>
          </div>
        </div>
        <div class="device-item">
          <span class="device-icon">ğŸ“±</span>
          <div class="device-info">
            <h4>Mobile App Tracker</h4>
            <p>Status: <span class="status-active">æ¥ç¶šä¸­</span></p>
          </div>
        </div>
      </div>
      <button class="btn-secondary" routerLink="/risk-assessment/iot-monitor">
        ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
      </button>
    </section>
  </div>
</div>