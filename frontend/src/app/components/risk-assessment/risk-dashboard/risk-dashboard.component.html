<div class="risk-dashboard">
  <header class="dashboard-header">
    <h1>リスク評価ダッシュボード</h1>
    <p class="subtitle">Risk Assessment & Dynamic Pricing Dashboard</p>
  </header>

  <div class="dashboard-grid">
    <!-- Driver List -->
    <section class="card driver-list">
      <h2>ドライバー一覧</h2>
      <div class="drivers">
        <div *ngFor="let driver of driverProfiles" 
             class="driver-card"
             (click)="analyzeDriver(driver.id)">
          <div class="driver-info">
            <h3>{{ driver.name }}</h3>
            <p>ID: {{ driver.id }} | 年齢: {{ driver.age }}歳</p>
          </div>
          <div class="risk-badge" [style.background-color]="getRiskColor(driver.category)">
            <span class="risk-score">{{ driver.riskScore }}</span>
            <span class="risk-label">{{ getJapaneseRiskLabel(driver.category) }}</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Risk Score Card -->
    <section class="card risk-analysis" *ngIf="currentRiskScore">
      <h2>リスク分析結果</h2>
      <div class="score-display">
        <div class="score-circle" [style.border-color]="getRiskColor(currentRiskScore.riskCategory)">
          <span class="score-value">{{ currentRiskScore.riskScore }}</span>
          <span class="score-max">/100</span>
        </div>
        <div class="score-details">
          <h3>{{ getJapaneseRiskLabel(currentRiskScore.riskCategory) }}</h3>
          <p>推奨保険料: ¥{{ currentRiskScore.recommendedPremium.toLocaleString() }}</p>
          <p class="discount" *ngIf="currentRiskScore.discount > 0">
            割引額: ¥{{ currentRiskScore.discount.toLocaleString() }}
          </p>
        </div>
      </div>

      <div class="risk-factors">
        <h3>リスク要因の内訳</h3>
        <div class="factor" *ngFor="let factor of getFactorArray(currentRiskScore.factors)">
          <span class="factor-label">{{ factor.label }}</span>
          <div class="factor-bar">
            <div class="factor-fill" [style.width.%]="factor.value"></div>
          </div>
          <span class="factor-value">{{ factor.value }}</span>
        </div>
      </div>
    </section>

    <!-- Scenario Simulator -->
    <section class="card scenario-sim">
      <h2>シナリオシミュレーター</h2>
      <div class="simulator-controls">
        <label for="scenario">シナリオを選択:</label>
        <select id="scenario" [(ngModel)]="selectedScenario" class="scenario-select">
          <option value="newDriver">新規ドライバー (22歳)</option>
          <option value="elderly">高齢ドライバー (68歳)</option>
          <option value="safeDriving">安全運転者 (40歳)</option>
        </select>
        <button (click)="simulateScenario()" [disabled]="loading" class="btn-primary">
          {{ loading ? 'シミュレーション中...' : 'シミュレーション実行' }}
        </button>
      </div>
      <div class="simulator-info">
        <p>🚗 Usage-based insurance (UBI) 対応</p>
        <p>📊 National Police Agency データ統合</p>
        <p>🔌 OBD-II デバイス連携</p>
      </div>
    </section>

    <!-- IoT Integration Status -->
    <section class="card iot-status">
      <h2>IoTデバイス状況</h2>
      <div class="device-list">
        <div class="device-item">
          <span class="device-icon">🔌</span>
          <div class="device-info">
            <h4>OBD-II Tracker #1</h4>
            <p>Status: <span class="status-active">アクティブ</span></p>
          </div>
        </div>
        <div class="device-item">
          <span class="device-icon">📱</span>
          <div class="device-info">
            <h4>Mobile App Tracker</h4>
            <p>Status: <span class="status-active">接続中</span></p>
          </div>
        </div>
      </div>
      <button class="btn-secondary" routerLink="/risk-assessment/iot-monitor">
        リアルタイムモニタリング
      </button>
    </section>
  </div>
</div>